# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
---
# Архитектура проекта
В проекте используется архитектурный паттерн MVP (Model-View-Presenter). В соответствии с данным паттерном приложение разделено на три основных слоя: слой данных (Model), слой отображения (View), и слой представления (Presenter). Слои модели и отображения не связаны между собой, взаимодействие между этими слоями организовано с помощью слоя представления. В архитектуре проекта применен событийно-ориентированный подход. 
## Базовый код
### 1. Класс `Api`
Базовый класс-клиент API для взаимодействия с сервером, предоставляет методы для выполнения HTTP-запросов к серверу и обработки ответа сервера.

Конструктор класса принимает два аргумента – базовый URL `baseURL` и объект опций HTTP-запроса `options`, инициализированный по умолчанию пустым объектом:
`constructor(baseUrl: string, options: RequestInit = {})`.

**Методы:**

- `handleResponse` – обработать ответ сервера.

- `get` – выполнить запрос данных с сервера.

- `post` – отправить данные на сервер.

### 2. Класс `Model<T>`
Базовый абстрактный класс модели данных. Содержит методы, общие для всех моделей данных. Класс является дженериком и принимает в переменной T тип данных в модели данных.

Конструктор класса принимает два аргумента – объект с частичными данными типа T `data` и объект брокера событий `events`:
`constructor(data: Partial<T>, protected events: IEvents)`.

**Методы:**

- `emitChanges` – метод сообщает об изменении модели данных с помощью брокера событий.

### 3. Класс `EventEmitter`
Базовый класс, представющий брокер событий. Класс реализует паттерн Наблюдатель (Observer) и предоставляет возможность управлять событиями в приложении: инициировать события, подписываться и реагировать на события.

Конструктор класса не принимает аргументов: `constructor()`.

**Методы:**

- `emit`, `on`, `off` – инициировать событие с данными, установить и снять обработчик с события соответственно.
- `onAll`, `offAll` – слушать все события и сбросить все обработчики событий соответственно.
- `trigger` – сделать коллбек триггер, генерирующий событие при вызове.

### 4. Класс `Component`
Базовый абстрактный класс, наследуемый компонентами отображения. Содержит методы для работы с DOM в дочерних компонентах.

Конструктор класса в качестве аргумента принимает DOM-элемент, который будет служить контейнером для компонента: `constructor(protected readonly container: HTMLElement)`.

**Методы:**

- `toggleClass` – переключить класс элемента.
- `setText` – установить текстовое содержимое элемента.
- `setDisabled` – изменить статус блокировки элемента.
- `setHidden`, `setVisible` – скрыть и показать элемент соответственно.
- `setImage` – установить изображение с альтернативным текстом.
- `render` – вернуть корневой DOM-элемент.

## Слой модели данных Model
### 1. Класс `WebLarekAPI`
Класс расширяет базовый класс `Api` и предназначен для работы с товарами и заказами на сервере посредством API. В классе реализована логика получения, отправки и обработки данных о товарах и заказах.

Конструктор класса, помимо аргументов родительского конструктора, принимает базовый URL для изображений `cdn`: `constructor(cdn: string, baseUrl: string, options?: RequestInit)`.

**Методы:**

- `getProductList(): Promise<IProduct[]>` – получить массив всех товаров с сервера.
- `getProductItem(id: string): Promise<IProduct>` – получить один товар с сервера по идентификатору.
- `orderProducts(order: IOrder): Promise<IOrderResult>` – отправить данные заказа на сервер.

### 2. Класс `AppState`
Класс расширяет базовый класс `Model<IAppState>` и предназначен для хранения и управления состоянием приложения. Поля класса хранят информацию о товарах, состоянии корзины и заказа, ошибках валидации полей в формах. Методы класса позволяют на уровне данных воспроизвести бизнес-логику приложения.

Конструктор родительского класса не переопределен.

**Поля:**

- `catalog: IProduct[]` - каталог товаров магазина.
- `basket: IProduct[]` - товары, добавленные в корзину.
- `order: IOrder` - данные заказа.
- `preview: string | null` - идентификатор просматриваемого товара.
- `formErrors: FormErrors` - объект для хранения ошибок валидации полей в формах.

**Методы:**

- `setCatalog(items: IProduct[])` – установить каталог товаров.
- `setPreview(item: IProduct)` – установить просматриваемый товар.
- `addToBasket(item: IProduct)` – добавить товар в корзину.
- `getBasketAmount` – получить количество товаров в корзине.
- `getBasketTotal` – получить общую стоимость товаров в корзине.
- `deleteFromBasket(item: IProduct)` – удалить один товар из корзины.
- `deleteAllFromBasket` – удалить все товары из корзины.
- `resetOrder` – сбросить данные заказа.
- `setOrderField(field: keyof IOrderForm, value: string)` – установить способ оплаты и адрес.
- `setContactsField(field: keyof IOrderContacts, value: string )` – установить почту и телефон.
- `validateOrder` – отвалидировать данные формы с адресом и оплатой.
- `validateContacts` – отвалидировать данные формы с контактами.



